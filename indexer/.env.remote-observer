# ASI-Chain Indexer Configuration for Remote Observer Node
# This configuration connects to the read-only/observer node on the remote server
# Optimized for querying and indexing without transaction capabilities

# ==========================================
# Remote Observer Node Configuration
# ==========================================
# Using the read-only/observer node for best query performance
NODE_HOST=13.251.66.61
GRPC_PORT=40452              # Read-only/Observer gRPC port
HTTP_PORT=40453              # Read-only/Observer HTTP port

# Alternative: Use Validator1 if observer is unavailable
# GRPC_PORT=40412            # Validator1 gRPC port  
# HTTP_PORT=40413            # Validator1 HTTP port

# ==========================================
# Rust CLI Configuration
# ==========================================
# Path to the Rust CLI binary inside Docker container
RUST_CLI_PATH=/usr/local/bin/node_cli

# For local development without Docker, use:
# RUST_CLI_PATH=../rust-client/target/release/node_cli

# ==========================================
# Database Configuration (Local)
# ==========================================
DATABASE_URL=postgresql://indexer:indexer_pass@postgres:5432/asichain
DATABASE_POOL_SIZE=20
DATABASE_POOL_TIMEOUT=10

# ==========================================
# Synchronization Settings
# ==========================================
SYNC_INTERVAL=5               # Check for new blocks every 5 seconds
BATCH_SIZE=50                # Process up to 50 blocks per batch
START_FROM_BLOCK=0           # Start from genesis (or set to recent block for faster sync)

# To start from a recent block (e.g., last 100 blocks):
# START_FROM_BLOCK=1900      # Adjust based on current chain height

# ==========================================
# Feature Flags
# ==========================================
ENABLE_REV_TRANSFER_EXTRACTION=true    # Extract REV token transfers
ENABLE_METRICS=true                    # Enable Prometheus metrics
ENABLE_HEALTH_CHECK=true               # Enable health endpoints

# ==========================================
# Monitoring & API
# ==========================================
MONITORING_PORT=9090          # Indexer REST API port
HEALTH_CHECK_INTERVAL=60      # Health check interval in seconds

# ==========================================
# Logging Configuration
# ==========================================
LOG_LEVEL=INFO               # Options: DEBUG, INFO, WARNING, ERROR
LOG_FORMAT=json              # Options: json, text

# ==========================================
# Hasura GraphQL Configuration
# ==========================================
HASURA_ADMIN_SECRET=myadminsecretkey   # Change in production!

# ==========================================
# Docker Networking (for Docker deployment)
# ==========================================
# When running in Docker on Mac/Windows, you might need:
# NODE_HOST=host.docker.internal
# But since we're connecting to remote server, use actual IP:
# NODE_HOST=13.251.66.61

# ==========================================
# Performance Tuning
# ==========================================
# Increase for faster initial sync (uses more memory)
# BATCH_SIZE=100

# Decrease for more frequent updates (uses more CPU)
# SYNC_INTERVAL=2

# ==========================================
# Notes
# ==========================================
# 1. This configuration uses the read-only/observer node for optimal query performance
# 2. The observer node (ports 40452/40453) is best for indexing as it doesn't handle transactions
# 3. All data is stored locally in PostgreSQL for fast queries
# 4. Hasura provides GraphQL API on top of the indexed data
# 5. The indexer will automatically catch up from START_FROM_BLOCK to the latest block